# NOTE
# TODO: Defaultのキーはunbind-keyしておいた行儀が良さそう

# prefixキー設定
unbind-key C-b
set-option -g prefix C-q
bind-key C-q send-prefix

# キーストロークのディレイを減らす(Escの効きがよくなるらしい)
# set -sg escape-time 1
set -s escape-time 0

# #キーバインドをviに変更
# set-window-option -g mode-keys vi
# TODO

# utf8を有効にする
# set-window-option -g utf8 on
# set-window-option -g status-utf8 on

# 設定リロード
bind-key r source-file ~/.tmux.conf \; display-message "Reloaded config !!"

# メッセージ表示時間指定
set-option -g display-time 1000
set-option -g display-panes-time 1000

# tmuxを256色表示できるようにする
set-option -g default-terminal screen-256color
set -g terminal-overrides 'xterm:colors=256'

# ステータスバーを1秒毎に描画し直す
set-option -g status-interval 1

# ステータスバーの色を設定する
set-option -g status-bg "colour238"

# status line の文字色を指定する。
set-option -g status-fg "colour255"


# status-left の最大の長さを指定する。
# デフォルトはleftが10, rightが40
set-option -g status-left-length 30

# status-left のフォーマットを指定する。
# set-option -g status-left "#[fg=colour255,bg=colour241]Session: #S #[default]"
# set-option -g status-left "#[fg=colour255,bg=colour232]Session: #S #[default]"
# set-option -g status-left "#[fg=colour255,bg=colour127]Session: #S #[default]"
set-option -g status-left "#[fg=colour21,bg=colour255]Session: #S #[default]"

# status-rightの最大の長さを指定する。
set-option -g status-right-length 60

# status-right のフォーマットを指定する。
# set-option -g status-right "#[fg=colour255,bg=colour241] #h | %m/%d %H:%M:%S#[default]"
# set-option -g status-right "#[fg=colour232,bg=colour196,bold] #h | %m/%d %H:%M:%S#[default]"
set-option -g status-right "#[fg=colour255,bg=colour196] #h | %m/%d %H:%M:%S#[default]"
# set-option -g status-right "#[fg=colour160,bg=colour255,bold] #h | %m/%d %H:%M:%S#[default]"
# set-option -g status-right "#[fg=colour225,bg=colour127,bold] #h | %m/%d %H:%M:%S#[default]"

# window-status のフォーマットを指定する。
set-window-option -g window-status-format " #I: #W"

# カレントウィンドウの window-status のフォーマットを指定する
# set-window-option -g window-status-current-format "#[fg=colour255,bg=colour27,bold] #I: #W #[default]"
set-window-option -g window-status-current-format "#[fg=colour255,bg=colour33,bold] #I: #W #[default]"

# Window/Pane番号を1から開始
set-option -g base-index 1
set-window-option -g pane-base-index 1

# 新しいウィンドウを作成
bind-key -n M-t new-window

# Window名を変更
# TODO
bind-key -n M-r command-prompt -I "#W" "rename-window %%"

# # Window
# default: C-b + w 
# TODO
#
# # Window 強制終了
# default: C-b + & 
# TODO

# Windowを閉じる
# Paneを閉じるを複数回することで対応する
# bind-key -n M-w confirm-before 'kill-window'
# bind-key -n M-w kill-window

# 次のウィンドウへ移動
bind-key -n M-n next-window

# 前のウィンドウへ移動
bind-key -n M-p previous-window


# Pane番号を大きく表示
# bind-key i display-panes

# Pane番号へ移動
# TODO

# Paneを縦分割する
bind-key -n M-v split-window -h

# Paneを横縦分割する
bind-key -n M-s split-window -v

# Paneの移動(上下左右)
bind-key -n M-h select-pane -L
bind-key -n M-j select-pane -D
bind-key -n M-k select-pane -U
bind-key -n M-l select-pane -R

# Paneの移動(Rotate)
bind-key -n M-o select-pane -t :.+

# Paneを閉じる
bind-key -n M-q confirm-before 'kill-pane'
bind-key -n M-Q kill-pane

# Pane resize
bind-key -n M-Up    resize-pane -U 2
bind-key -n M-Down  resize-pane -D 2
bind-key -n M-Left  resize-pane -L 5
bind-key -n M-Right resize-pane -R 5
# bind-key -n M-H resize-pane -L 2
# bind-key -n M-J resize-pane -D 2
# bind-key -n M-K resize-pane -U 5
# bind-key -n M-L resize-pane -R 5

# !            ペインを解除してウインドウ化
# スペース      レイアウトを変更
# Alt-1-5      レイウトを変更
# {            ペインの入れ替え(前方向)
# }            ペインの入れ替え(後方向)
# ctrl+o       ペインの入れ替え(全体)
# 	t            ペインに時計を表示
# TODO

# Window一覧
# TODO
# # ウィンドウ一覧部における現在非アクティブなウィンドウの項目の表示
# set-window-option -g window-status-fg white
# set-window-option -g window-status-bg default
# set-window-option -g window-status-attr default
# # ウィンドウ一覧部における現在アクティブなウィンドウの項目の表示
# set-window-option -g window-status-current-fg white
# set-window-option -g window-status-current-bg colour24
# set-window-option -g window-status-current-attr bold

# # 初回シェル時のみ tmux実行
# if [ $SHLVL = 1 ]; then
#   tmux
#   fi
# TODO


# bind-key C-d detach
# TODO

#
# # コピーモードを設定する
# # コピーモードでvimキーバインドを使う
# setw -g mode-keys vi
#
# # 'v' で選択を始める
# bind -T copy-mode-vi v send -X begin-selection
#
# # 'V' で行選択
# bind -T copy-mode-vi V send -X select-line
#
# # 'C-v' で矩形選択
# bind -T copy-mode-vi C-v send -X rectangle-toggle
#
# # 'y' でヤンク
# bind -T copy-mode-vi y send -X copy-selection
#
# # 'Y' で行ヤンク
# bind -T copy-mode-vi Y send -X copy-line
#
# # 'C-p'でペースト
# bind-key C-p paste-buffer
# -----------
# アクティブなペインを隣のウィンドウに移すのは[S-Left],[S-Right]です。新しいウィンドウに移す場合、デフォルトの通り{!}です。
#
# # join pane
# bind-key -n S-Right join-pane -t :+
# bind-key -n S-Left join-pane -t :-
# アクティブなペインをある番号のウィンドウに移すには(S-num)です。
#
# # switch windows Alt+number
# bind-key -n M-! join-pane -t :1
# bind-key -n M-'"' join-pane -t :2
# bind-key -n M-'#' join-pane -t :3
# bind-key -n M-'$' join-pane -t :4
# bind-key -n M-% join-pane -t :5
# bind-key -n M-& join-pane -t :6
# bind-key -n M-"'" join-pane -t :7
# bind-key -n M-( join-pane -t :8
# 		bind-key -n M-) join-pane -t :9
# k
# ペインのスワップ(ペイン番号をずらす)は、(J),(K)
#
# # swap pane
# 	bind-key -n M-J swap-pane -D
# 	bind-key -n M-K swap-pane -U
# 	アクティブなペインを最大化するには(f)
#
# # maximize pane ("f"ull screen)
# 	bind-key -n M-f resize-pane -Z
# 	ペインのレイアウトを変更するには(Space)
#
# # next layout
# 	bind-key -n M-Space next-layout
# 	ペインのリサイズをするには、(a),(z),(h),(l)で上下左右に境界を動かすことができます。


# # コピーモードを設定する
# ## viのキーバインドを使用する
# setw -g mode-keys vi
# ## クリップボード共有を有効にする
# set-option -g default-command "reattach-to-user-namespace -l zsh"
# ## コピーモードの操作をvi風に設定する
# bind-key -T copy-mode-vi v send-keys -X begin-selection
# bind-key -T copy-mode-vi y send-keys copy-pipe-and-cancel "reattach-to-user-namespace pbcopy"
# unbind -T copy-mode-vi Enter
# bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "reattach-to-user-namespace pbcopy"

# Vim フレンドリな設定
# https://gist.github.com/anonymous/6bebae3eb9f7b972e6f0
# mux 2.4 では、以下の部分を:
#
# bind -t vi-copy 'v' begin-selection
# bind -t vi-copy 'y' copy-selection
# bind -t vi-copy 'Space' halfpage-down
# bind -t vi-copy 'Bspace' halfpage-up
# 以下のように変更してください:
#
# bind-key -T copy-mode-vi 'v' send -X begin-selection
# bind-key -T copy-mode-vi 'y' send -X copy-selection
# bind-key -T copy-mode-vi 'Space' send -X halfpage-down
# bind-key -T copy-mode-vi 'Bspace' send -X halfpage-up

# https://qiita.com/ssh0/items/b423d65f723eecb81527
